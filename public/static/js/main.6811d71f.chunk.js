(this["webpackJsonpcapstone-travel-map"]=this["webpackJsonpcapstone-travel-map"]||[]).push([[0],{146:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(38),r=a.n(i),o=(a(68),a(5)),l=a.n(o),c=a(8),u=a(9),p=a(10),d=a(13),m=a(11),h=a(12),g=a(7),f=a.n(g),v=a(18),E=a(22);f.a.defaults.withCredentials=!0;var w=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e)))._getRandomBackground=Object(c.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Math.floor(16*Math.random())+3,document.body.style.backgroundImage='url("./assets/desktop_'.concat(t,'.jpg")');case 2:case"end":return e.stop()}}),e)}))),a._handleSignInChange=function(e){a.setState({signIn:Object(E.a)({},a.state.signIn,Object(v.a)({},e.target.id,e.target.value)),signUp:Object(E.a)({},a.state.signUp,Object(v.a)({},e.target.id,e.target.value))})},a._handleSignUpChange=function(e){a.setState({signUp:Object(E.a)({},a.state.signUp,Object(v.a)({},e.target.id,e.target.value))})},a._handleSignIn=function(){var e=Object(c.a)(l.a.mark((function e(t){var n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,f.a.post("/signin",a.state.signIn);case 3:n=e.sent,s=n.data,200!==n.status||(s.id?a.props.signInUser(s):(document.getElementById("signin").classList.add("shake"),setTimeout((function(){document.getElementById("signin").classList.remove("shake")}),830),a.setState({showSignUp:!0})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a._handleSignUp=function(){var e=Object(c.a)(l.a.mark((function e(t){var n,s,i,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=a.state.signUp,s=n.email,i=n.password,!(s.includes("@")&&s.includes(".")&&i.length>1)){e.next=10;break}return e.next=5,f.a.post("/signin",a.state.signUp);case 5:r=e.sent,o=r.data,200!==r.status||(o.id?a.props.signInUser(o):(document.getElementById("signin").classList.add("shake"),setTimeout((function(){document.getElementById("signin").classList.remove("shake")}),830),a.setState({showSignUp:!0}))),e.next=12;break;case 10:document.getElementById("signin").classList.add("shake"),setTimeout((function(){document.getElementById("signin").classList.remove("shake")}),830);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a._toggleMenu=function(){a.setState({showSignUp:!a.state.showSignUp})},a.state={signIn:{email:"",password:""},signUp:{email:"",password:"",firstName:"",lastName:""},showSignUp:!1},a.props.showModal(),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this._getRandomBackground(),setTimeout(this.props.hideModal,750)}},{key:"render",value:function(){return s.a.createElement("div",{id:"signin",className:"container section"},s.a.createElement("form",{onSubmit:this.state.showSignUp?this._handleSignUp:this._handleSignIn,className:"white signin-signup"},s.a.createElement("div",{className:"logo-tagline"},s.a.createElement("img",{src:"./assets/flaminGO_logo.png",width:"100%",className:"site-logo-landing center",alt:"",title:"Flamingo Logo"}),s.a.createElement("p",{className:"tagline"},"Your leg up on trip management")),s.a.createElement("h5",{className:"grey-text text-darken-3 section"},this.state.showSignUp?"Sign Up":"Sign In"),s.a.createElement("div",{className:"input-field"},s.a.createElement("label",{htmlFor:"email"},"Email"),s.a.createElement("input",{type:"email",id:"email",required:!0,onChange:this._handleSignInChange})),s.a.createElement("div",{className:"input-field"},s.a.createElement("label",{htmlFor:"password"},"Password"),s.a.createElement("input",{type:"password",id:"password",required:!0,onChange:this._handleSignInChange}),this.state.showSignUp?null:s.a.createElement("span",{className:"helper-text right",onClick:this._toggleMenu},"Don't have an account? Sign up here.")),this.state.showSignUp?null:s.a.createElement("div",{className:"input-field"},s.a.createElement("button",{type:"submit",className:"btn teal lighten-1 z-depth-0"},"Sign In")),this.state.showSignUp?s.a.createElement("div",null,s.a.createElement("div",{className:"input-field"},s.a.createElement("label",{htmlFor:"firstName"},"First Name"),s.a.createElement("input",{type:"text",id:"firstName",required:!0,onChange:this._handleSignUpChange})),s.a.createElement("div",{className:"input-field"},s.a.createElement("label",{htmlFor:"lastName"},"Last Name"),s.a.createElement("input",{type:"text",id:"lastName",required:!0,onChange:this._handleSignUpChange}),this.state.showSignUp?s.a.createElement("span",{className:"helper-text right",onClick:this._toggleMenu},"Already have an account? Sign in here."):null),s.a.createElement("div",{className:"input-field"},s.a.createElement("button",{className:"btn teal lighten-1 z-depth-0"},"Sign Up"))):null))}}]),t}(n.Component);a(87);function b(e){var t=e.user,a=e.clearState;function n(){var e=document.getElementById("fab");e.classList.remove("foward-action-removed"),e.classList.add("foward-action-shown"),document.getElementsByClassName("picture-frame")[0].style="background-color:  #4db6ac"}function i(){return(i=Object(c.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,f.a.get("/signout");case 3:a();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var r=t.photoURL;return s.a.createElement("div",{className:"museum",onMouseLeave:function(){var e=document.getElementById("fab");e.classList.remove("foward-action-shown"),e.classList.add("foward-action-removed"),document.getElementsByClassName("picture-frame")[0].style="background-color: #26a69a"}},s.a.createElement("div",{className:"gallery-wall",onMouseEnter:n,onClick:n},s.a.createElement("div",{className:"picture-frame"},r?s.a.createElement("img",{alt:"",src:"photos/".concat(r)}):s.a.createElement("p",null,"".concat(t.firstName[0]).concat(t.lastName[0])))),s.a.createElement("div",{id:"fab",className:"foward-action-removed"},s.a.createElement("ul",null,s.a.createElement("a",{href:"#profile",className:"modal-trigger"},s.a.createElement("li",{title:"Edit Profile",className:"btn btn-floating fab-buttons"},s.a.createElement("i",{className:"fas fa-user-cog"}))),s.a.createElement("a",null,s.a.createElement("li",{title:"Sign Out",onClick:function(e){return function(e){return i.apply(this,arguments)}(e)},className:"btn btn-floating fab-buttons"},s.a.createElement("i",{className:"fas fa-door-open"}))))))}var S=a(20),y=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e)))._updateField=function(e){var t=e.target;a.setState(Object(v.a)({},t.id,t.textContent),a._showSaving)},a._saveChanges=Object(c.a)(l.a.mark((function e(){var t,n,s,i,r,o,c,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.querySelectorAll("[data-password]").forEach((function(e){e.style="visibility: hidden;",e.value=""})),a.setState({tooltipShouldShow:!1}),t=a.state,n=t.firstName,s=t.lastName,i=t.email,r=t.photoURL,o=t.newPassword,c=t.latestPhotoURL,u={firstName:n,lastName:s,email:i,photoURL:c},!o){e.next=8;break}return e.next=8,f.a.post("/users/password",{password:o});case 8:if(n===a.props.firstName&&s===a.props.lastName&&i===a.props.email&&r===a.props.photoURL&&null===o){e.next=13;break}return a._showSaving(),e.next=12,f.a.post("/users",u);case 12:a.props.updateLanding();case 13:case"end":return e.stop()}}),e)}))),a._showPasswordCheck=function(){var e=document.getElementById("oldpassword");e.style="visibility: visible;",e.addEventListener("keypress",a._listenForEnter),e.focus()},a._checkPassword=Object(c.a)(l.a.mark((function e(){var t,n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("oldpassword").value,e.next=3,f.a.post("/signin",{email:a.props.user.email,password:t});case 3:n=e.sent,(s=n.data).id?(document.getElementById("oldpassword").removeEventListener("keypress",a._listenForEnter),a._showNewPassword1()):401===s.status&&(document.getElementById("profile").classList.add("shake"),a.setTimeout=setTimeout((function(){document.getElementById("profile").classList.remove("shake")}),830));case 6:case"end":return e.stop()}}),e)}))),a._compareTwoPasswords=function(){var e=document.getElementById("oldpassword"),t=document.getElementById("newpassword1").value,n=document.getElementById("newpassword2").value;t===n?a.setState({newPassword:n},a._showSaving(),e.style="visibility: hidden;",e.value="",document.getElementById("newpassword1").style="visibility: hidden;",document.getElementById("newpassword1").value="",document.getElementById("newpassword2").style="visibility: hidden;",document.getElementById("newpassword2").value=""):(document.getElementById("profile").classList.add("shake"),setTimeout((function(){document.getElementById("profile").classList.remove("shake")}),830))},a._showNewPassword1=function(){var e=document.getElementById("newpassword1");e.style="visibility: visible;",e.focus()},a._showNewPassword2=function(){var e=document.getElementById("newpassword1"),t=document.getElementById("newpassword2");e.value?(t.style="visibility: visible;",t.focus()):(t.style="visibility: hidden;",e.focus())},a._attachListener=function(e){e.target.addEventListener("keypress",a._listenForEnter)},a._detachListener=function(e){e.target.removeEventListener("keypress",a._listenForEnter)},a._listenForEnter=function(e){13===e.keyCode&&(console.log(e.srcElement.id),"oldpassword"===e.srcElement.id?a._checkPassword():"newpassword1"===e.srcElement.id?a._showNewPassword2():"newpassword2"===e.srcElement.id&&a._compareTwoPasswords())},a._changeFileName=function(e){e.target.files[0]&&a.setState({fileName:e.target.files[0]},(function(){a._uploadFile(a.state.fileName)}))},a._uploadFile=function(e){var t=new FormData;t.append("file",e);var n=t;a.setState({photoFormData:n},Object(c.a)(l.a.mark((function e(){var t,n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/users/profilepic",a.state.photoFormData,{headers:{"content-type":"multipart/form-data"}});case 2:t=e.sent,n=t.data,s=n.newPic[0].photo_url,a.setState({latestPhotoURL:s,tooltipShouldShow:!0});case 6:case"end":return e.stop()}}),e)}))),a._showSaving())},a._choosePicture=function(){},a._showPhotoInput=function(){document.getElementsByClassName("fileupload-icon")[0].style="opacity: 1;"},a._hidePhotoInput=function(){document.getElementsByClassName("fileupload-icon")[0].style="opacity: 0;"},a._undoPhoto=Object(c.a)(l.a.mark((function e(){var t,n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/users/profilepic/undo",{url:a.state.photoURL});case 2:t=e.sent,n=t.data,s=n.newPic[0].photo_url,a.setState({latestPhotoURL:s},(function(){a.setState({tooltipShouldShow:!1,fileName:null}),document.getElementById("pictureinput").value=null}),a._showSaving());case 6:case"end":return e.stop()}}),e)}))),a._showSaving=function(){var e=a.state,t=e.firstName,n=e.lastName,s=e.email,i=e.photoURL,r=e.newPassword;(r||t!==a.props.firstName||n!==a.props.lastName||s!==a.props.email||i!==a.props.photoURL||null!==r)&&(document.getElementById("saving").style.display="inline",a.autoSave=setTimeout((function(){document.getElementById("saving").style.display="none"}),1e3))};var n=a.props.user,s=n.firstName,i=n.lastName,r=n.email,o=n.photoURL;return a.state={firstName:s,lastName:i,email:r,photoURL:o,newPassword:null,fileName:null,photoFormData:null,latestPhotoURL:o||null,tooltipShouldShow:!1},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentWillUnmount",value:function(){clearTimeout(this.setTimeout),clearTimeout(this.autoSave)}},{key:"render",value:function(){var e=this,t=this.props.user,a=this.state.latestPhotoURL?this.state.latestPhotoURL:this.state.photoURL,n={onCloseStart:this._saveChanges};return s.a.createElement(S.Modal,{id:"profile",options:n},s.a.createElement("div",{className:"profile-modal"},s.a.createElement("div",{id:"saving"},s.a.createElement("p",null,"Saving changes...")),s.a.createElement("div",{className:"profile-top-row"},s.a.createElement("div",{className:"profile-picture-frame",onClick:this._choosePicture,onMouseEnter:this._showPhotoInput,onMouseLeave:this._hidePhotoInput},a?s.a.createElement("img",{alt:"",src:"photos/".concat(a)}):s.a.createElement("p",null,"".concat(this.state.firstName[0]).concat(this.state.lastName[0])),s.a.createElement("div",{className:"fileupload-wrapper"},s.a.createElement("input",{type:"file",id:"pictureinput",onChange:this._changeFileName,accept:"image/png, image/jpeg, image/jpg, image/gif"})),s.a.createElement("div",{className:"fileupload-icon"},s.a.createElement("i",{className:"material-icons"},"add"))),s.a.createElement("span",{id:"phototip",onClick:this._undoPhoto,className:this.state.tooltipShouldShow?"grey darken-3 profile-tool-tip":"grey darken-3 tooltip-hidden"},"Undo?"),s.a.createElement("h3",{className:"user-name"},s.a.createElement("div",{id:"firstName",onBlur:this._updateField,contentEditable:!0,suppressContentEditableWarning:!0},t.firstName),s.a.createElement("div",null,"\xa0"),s.a.createElement("div",{id:"lastName",onBlur:this._updateField,contentEditable:!0,suppressContentEditableWarning:!0},t.lastName))),s.a.createElement("div",{className:"profile-second-row"},s.a.createElement("h5",{id:"email",onBlur:this._updateField,contentEditable:!0,suppressContentEditableWarning:!0},t.email),s.a.createElement("button",{className:"btn change-password-button",onClick:this._showPasswordCheck},"ChangePassword"),s.a.createElement("input",{id:"oldpassword",type:"password","data-password":!0,className:"old-password-input password-fields",placeholder:"Enter Old Password",onFocus:this._attachListener,onBlur:function(t){e._detachListener(t),e._checkPassword()}}),s.a.createElement("input",{id:"newpassword1",type:"password","data-password":!0,className:"new-password-input password-fields",placeholder:"Enter New Password",onFocus:this._attachListener,onBlur:function(t){e._detachListener(t),e._showNewPassword2()}}),s.a.createElement("input",{id:"newpassword2",type:"password","data-password":!0,className:"new-password-input password-fields",placeholder:"Enter New Password Again",onFocus:this._attachListener,onBlur:function(t){e._detachListener(t),e._compareTwoPasswords()}}))))}}]),t}(s.a.Component);function _(e){var t=e.user,a=e.clearState,n=e.updateLanding;return s.a.createElement("nav",{className:"nav-wrapper grey darken-3"},s.a.createElement("img",{src:"./assets/flaminGO_logo.png",height:"50",className:"left site-logo",alt:"",title:"Flamingo Logo"}),s.a.createElement("div",{className:""},s.a.createElement(b,{user:t,clearState:a}),s.a.createElement(y,{user:t,updateLanding:n})))}var N=a(15),k=a.n(N);function T(e){var t=e.selectedTrip,a=e.tripSelector,n=e.tripDeselector,i=e.trips,r=e.clickedTrip;return s.a.createElement("div",{className:"trip-list"},s.a.createElement("ul",{className:"trip-unordered-list"},i&&i.map((function(e){var i=e.id,o=e.trip_location,l="";return l=t===i?"trip-list-item-hover":"",s.a.createElement("li",{key:i,onClick:function(){return r(i)},onMouseEnter:function(){a(i)},onMouseLeave:n,className:"trip-list-item ".concat(l," "),style:{color:"black"}},o)}))))}var C=a(44),I=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e)))._onChangeHandler=function(e){a.setState({viewport:Object(E.a)({},e)})},a._assignMapDimensions=function(){var e=document.getElementById("mapbox").offsetWidth,t=document.getElementById("mapbox").offsetHeight;a.setState({viewport:Object(E.a)({},a.state.viewport,{width:e,height:t})})},a.state={viewport:{latitude:37.785164,longitude:0,zoom:1.25,bearing:0,pitch:0,width:500,height:500}},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this._assignMapDimensions(),window.addEventListener("resize",this._assignMapDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._assignMapDimensions)}},{key:"render",value:function(){var e=this,t=this.state.viewport,a=this.props,n=a.trips,i=a.selectedTrip,r=a.clickedTrip,o=k()(new Date).format(),l=n&&n.map((function(t){var a=t.id,n=(t.trip_location,t.trip_date),l=(t.trip_details,t.lat),c=t.lon,u=(t.photos,"");u=i===a?"fa-map-pin-hover":"";var p=k()(n.split("T").shift()).format();return s.a.createElement("div",{key:a,onClick:function(){return r(a)},onMouseEnter:function(){e.props.tripSelector(a)},onMouseLeave:e.props.tripDeselector},s.a.createElement(C.a,{latitude:parseFloat(l),longitude:parseFloat(c),offsetTop:-12,key:a},p>o?s.a.createElement("i",{style:{color:"#2196f3"},className:"fas fa-map-pin ".concat(u)}):s.a.createElement("i",{style:{color:"#c62828"},className:"fas fa-map-pin ".concat(u)})))}));return s.a.createElement(C.b,Object.assign({className:"mapbox-gl"},t,{mapStyle:"mapbox://styles/mapbox/satellite-streets-v9",onViewportChange:this._onChangeHandler,mapboxApiAccessToken:"pk.eyJ1Ijoiam9uYXRoYW5yYXkxNyIsImEiOiJjanZ3aHd1ZzM0Y3B5NDlxcjRsbnIzcTAxIn0.ygYs-iXNclW8pJeuknEvJA"}),l)}}]),t}(n.Component);function D(e){var t=e.changePast,a=e.changeFuture;return s.a.createElement("div",{className:"triptoggle"},s.a.createElement("div",{className:"past"},s.a.createElement("label",null,"Past Trips"),s.a.createElement("div",{className:"switch"},s.a.createElement("label",null,"hide",s.a.createElement("input",{type:"checkbox",defaultChecked:!0,onChange:t}),s.a.createElement("span",{className:"lever"}),"show"))),s.a.createElement("p",null),s.a.createElement("div",{className:"future"},s.a.createElement("label",null,"Future Trips"),s.a.createElement("div",{className:"switch"},s.a.createElement("label",null,"hide",s.a.createElement("input",{type:"checkbox",defaultChecked:!0,onChange:a}),s.a.createElement("span",{className:"lever"}),"show"))))}a(133);var O=a(30),j=a.n(O),x=a(31),L=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(v.a)({},e.target.id,e.target.value))},a.handleLocation=function(e){a.setState({location:e.target.value},(function(){a.geocodeSearch()}))},a.handleDateChange=function(e){a.setState({date:[e][0]})},a.handleSubmit=function(){var e=Object(c.a)(l.a.mark((function e(t){var n,s,i,r,o,c,u,p,d,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.state,s=n.location,i=n.date,r=n.lat,o=n.lon,c=n.details,u=n.photoFormData,p={location:s,date:i,lat:r,lon:o,details:c},e.next=5,f.a.post("/trips/add",p);case 5:if(d=e.sent,m=d.data,!a.state.fileName){e.next=11;break}return u.append("tripId",m.tripID.id),e.next=11,f.a.post("/photos",u,{headers:{"content-type":"multipart/form-data"}});case 11:a.props.hushModal(),a.props.updateAppDashboard();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.geocodeSearch=Object(c.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/cors",{location:a.state.location});case 2:t=e.sent,n=t.data,a.setState({response:n.data.features,suggestions:n.data.features});case 5:case"end":return e.stop()}}),e)}))),a.getSuggestionValue=function(e){var t=e.place_name,n=e.center,s=n[1],i=n[0];return a.setState({lat:s,lon:i}),t},a.updateAutosuggestField=function(e,t){var n=t.newValue;a.setState({value:n,location:n},(function(){a.geocodeSearch()}))},a.getSuggestions=function(e){var t=e.trim().toLowerCase(),n=t.length;return(0===n?[]:a.state.response.length>0?a.state.response.filter((function(e){return e.place_name.toLowerCase().slice(0,n)===t})):[]).map((function(e){return e.place_name}))},a.onSuggestionsFetchRequested=function(e){var t=e.value;a.setState({suggestions:a.getSuggestions(t)})},a.onSuggestionsClearRequested=function(){a.setState({suggestions:[]})},a._onMouseLeave=function(e){var t=e.target;t.classList.remove("lighten-2"),t.classList.add("lighten-1")},a._onMouseEnter=function(e){var t=e.target;t.classList.remove("lighten-1"),t.classList.add("lighten-2")},a._onDrop=function(){var e=Object(c.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new FormData,t.forEach((function(e,t){n.append("file".concat(t),e)})),a.setState({photoFormData:n,fileName:!0,files:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={shouldDisplay:!0,location:"",date:null,lat:null,lon:null,details:"",response:[],fileName:!1,tripId:null,message:null,value:"",suggestions:[],photoFormData:[],files:[]},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentWillUnmount",value:function(){this.props.comeBack()}},{key:"render",value:function(){var e=this.state.files.map((function(e){return s.a.createElement("li",{key:e.name},e.name," - ",e.size," bytes")})),t=this.state,a=t.value,n=t.suggestions,i={placeholder:"Choose a destination",value:a,onChange:this.updateAutosuggestField};return s.a.createElement(S.Modal,{id:"newtrip",className:"Modal"},s.a.createElement("div",{className:"container add-new-trip-container"},s.a.createElement("form",{onSubmit:this.handleSubmit,id:"myform",className:"white",method:"post",encType:"multipart/form-data",action:"/upload"},s.a.createElement("h5",{className:"grey-text text-darken-3"},"Add a New Trip"),s.a.createElement(j.a,{suggestions:n,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:this.getSuggestionValue,renderSuggestion:function(e,t){t.query,t.isHighlighted;return s.a.createElement("div",null,e.place_name)},inputProps:i,highlightFirstSuggestion:!0,focusInputOnSuggestionClick:!1}),s.a.createElement("div",{className:"input-field"},s.a.createElement("label",{htmlFor:"date"}),s.a.createElement(S.DatePicker,{type:"text",id:"date",placeholder:"Date",className:"datepicker",required:!0,onChange:this.handleDateChange})),s.a.createElement("div",{className:"input-field"},s.a.createElement("label",{htmlFor:"details"}),s.a.createElement("textarea",{id:"details",className:"materialize-textarea",placeholder:"Trip Details / Itinerary",onChange:this.handleChange})),s.a.createElement(x.a,{onDrop:this._onDrop,accept:"image/*",minSize:0,maxSize:5242880,multiple:!0},(function(t){var a=t.getRootProps,n=t.getInputProps,i=t.isDragActive,r=t.isDragReject,o=t.isFileTooLarge;return s.a.createElement("section",{className:"container dragdrop center"},s.a.createElement("div",Object.assign({className:"dragdrop-div"},a()),s.a.createElement("div",{className:"btn-floating addtripphotobtn"},s.a.createElement("i",{className:"material-icons "},"add")),s.a.createElement("input",n()),s.a.createElement("p",{className:"dragDrop-p"},e.length>0?s.a.createElement("ul",null,e.map((function(e){return s.a.createElement("li",null,e.key)}))):null,0===e.length&&!i&&"Upload photos for your trip!",0===e.length&&i&&!r&&"Drop it like it's hot!",0===e.length&&r&&"File type not accepted, sorry!",0===e.length&&o&&s.a.createElement("div",{className:"text-danger mt-2"},"File is too large."))))})),s.a.createElement("div",{className:"input-field"},this.state.lat&&this.state.date?s.a.createElement("button",{"data-dismiss":"modal",onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,className:"btn teal lighten-1 z-depth-1",type:"submit",onClick:this.handleSubmit},"Submit"):s.a.createElement(S.Button,{disabled:!0},"Submit")))))}}]),t}(n.Component);function B(e){var t=e.search;return s.a.createElement("div",{className:"searchbar"},s.a.createElement("input",{type:"text",autoFocus:"autofocus",placeholder:"Search Trips",onChange:t}))}var M=a(29),F=a(57),P=a(40),U=a.n(P);function R(){var e=Object(F.a)(["\n    & .react-autosuggest__input{\n        font-size: 18px !important;\n    }\n    @media only screen and (min-width: 1020px){\n        & .react-autosuggest__input{\n            font-size: 30px !important;\n        }\n    }\n    "]);return R=function(){return e},e}var A=a(58).a.div(R()),Y=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e)))._saveChanges=function(){var e=a.state,t=e.value,n=e.details,s=e.lat,i=e.lon,r=document.getElementById("editTripDate".concat(a.props.id)).value.toString(),o=k()(r,"MMM Do YYYY").format("YYYY-MM-DD"),l=k()(a.props.date).format("YYYY-MM-DD"),c={trip_location:t,trip_date:o,lat:s,lon:i,trip_details:n};a.state.deleteThisTrip&&f.a.delete("trips/delete/".concat(a.props.id)).then((function(){return a.props.updateAppDashboard()})),t===a.props.name&&o===l&&n===a.props.details||f.a.post("/trips/edit/".concat(a.props.id),c).then((function(){return a.props.updateAppDashboard()})),a.props.shutTheDoorBehindYou()},a._updateName=function(){},a._editName=function(e){a.setState({editName:!0})},a._updateDate=function(e){var t=e.toString();document.getElementById("editTripDate".concat(a.props.id)).value=t,a._showSaving()},a._editDate=function(e){a.setState({editDate:!0})},a._updateDetails=function(e){a.setState({details:e},a._showSaving)},a._editDetails=function(e){a.setState({editDetails:!0})},a._updatePhotos=function(e){a.setState({photos:e},a._showSaving)},a._toggleDeleteTrip=function(){a.setState({deleteThisTrip:!a.state.deleteThisTrip},a._showSaving)},a._getPhotos=Object(c.a)(l.a.mark((function e(){var t,n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/trips/photos/".concat(a.props.id));case 2:t=e.sent,n=t.data,s=n.imgs,a.setState({photos:s});case 6:case"end":return e.stop()}}),e)}))),a._removePulse=function(){document.getElementById("addTripPhotos").classList.remove("pulse")},a._choosePicture=function(){document.getElementById("tripPhotoInput").click()},a._showSaving=function(){var e=a.state,t=e.name,n=e.details,s=e.photos,i=document.getElementById("editTripDate".concat(a.props.id)).value.toString();i=k()(i).format("YYYY-MM-DD"),t===a.props.name&&i===a.props.date&&n===a.props.details&&s===a.props.photos||(document.getElementById("savingTrip").style.display="inline",a.saving=setTimeout((function(){document.getElementById("savingTrip").style.display="none"}),1e3))},a.geocodeSearch=Object(c.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/cors",{location:a.state.location});case 2:t=e.sent,n=t.data,a.setState({response:n.data.features,suggestions:n.data.features},(function(){a.state.response.forEach((function(e){}))}));case 5:case"end":return e.stop()}}),e)}))),a.getSuggestionValue=function(e){var t=e.place_name,n=e.center,s=n[1],i=n[0];return a.setState({lat:s,lon:i},a._showSaving()),t},a.updateAutosuggestField=function(e,t){var n=t.newValue;a.setState({value:n,location:n},(function(){a.geocodeSearch()}))},a.getSuggestions=function(e){var t=e.trim().toLowerCase(),n=t.length;return(0===n?[]:a.state.response.length>0?a.state.response.filter((function(e){return e.place_name.toLowerCase().slice(0,n)===t})):[]).map((function(e){return e.place_name}))},a.onSuggestionsFetchRequested=function(e){var t=e.value;a.setState({suggestions:a.getSuggestions(t)})},a.onSuggestionsClearRequested=function(){a.setState({suggestions:[]})},a._onDrop=function(){var e=Object(c.a)(l.a.mark((function e(t){var n,s,i,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,n=new FormData,t.forEach((function(e,t){n.append("file".concat(t),e)})),n.append("tripId",a.props.id),e.next=6,f.a.post("/photos",n,{headers:{"content-type":"multipart/form-data"}});case 6:s=e.sent,i=s.data,r=i.trip_photos,a.setState({photos:r});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a._deleteMe=Object(c.a)(l.a.mark((function e(){var t,n,s,i,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.photos,n=t[a.materializeCarouselInstance.center],e.next=4,f.a.delete("/photos/".concat(a.props.id,"/").concat(n));case 4:s=e.sent,i=s.data,r=i.photos,a.materializeCarouselInstance.destroy(),a.setState({deleteAPhoto:!1,deleteMe:null,photos:r,carouselShouldSpin:!0});case 9:case"end":return e.stop()}}),e)}))),a.state={name:a.props.name,value:a.props.name,date:a.props.date,details:a.props.details,photos:a.props.photos,lat:a.props.lat,lon:a.props.lon,deleteThisTrip:!1,suggestions:[],response:[],files:[],deleteAPhoto:!1,deleteMe:null,carouselShouldSpin:!0},a._updateDate.bind(Object(M.a)(a)),a.carouselInstance=s.a.createRef(),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){U.a.Datepicker.init(document.getElementById("editTripDate".concat(this.props.id)),{autoClose:!0,onSelect:this._updateDate}),this.state.photos&&this.state.photos.length>0&&this.setState({carouselShouldSpin:!1})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.saving)}},{key:"render",value:function(){var e=this;setTimeout((function(){e.state.photos&&e.state.photos.length>0&&(e.materializeCarouselInstance=U.a.Carousel.init(e.carouselInstance.current,{fullWidth:!0,indicators:!1}))}),500);var t=this.state,a=t.suggestions,n=t.files,i=t.photos,r={placeholder:"Choose a destination",value:this.state.value,onChange:this.updateAutosuggestField},o=this.props,l=o.id,c=o.date,u=o.details,p=o.lat,d=o.lon,m={onCloseStart:function(){e._saveChanges()},onOpenEnd:function(){console.log(e.state.name,l)}};c=k()(c).format("MMM Do YYYY");var h=null;return i&&i.length>0&&(h=i.map((function(e,t){return s.a.createElement("a",{key:t,className:"carousel-item"},s.a.createElement("img",{src:"photos/".concat(e),alt:""}))}))),s.a.createElement(S.Modal,{id:"tripdetails",open:!0,options:m},s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{id:"savingTrip"},s.a.createElement("p",null,"Saving changes...")),s.a.createElement("a",{className:"btn-floating delete-trip-btn",title:this.state.deleteThisTrip?"undo":"delete trip",onClick:this._toggleDeleteTrip},s.a.createElement("i",{className:"material-icons"},this.state.deleteThisTrip?"undo":"delete")),s.a.createElement("span",{className:this.state.deleteThisTrip?"grey darken-3 undodelete-tooltip":"grey darken-3 tooltip-hidden"},"Undo Delete"),s.a.createElement("span",{className:"card-title"},s.a.createElement(A,null,s.a.createElement(j.a,{suggestions:a,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:this.getSuggestionValue,renderSuggestion:function(e,t){t.query,t.isHighlighted;return s.a.createElement("div",null,e.place_name)},inputProps:r,highlightFirstSuggestion:!0,focusInputOnSuggestionClick:!1}))),s.a.createElement("div",{className:"card-action grey-text"},s.a.createElement("input",{type:"text",id:"editTripDate".concat(l),className:"datepicker",defaultValue:c})),s.a.createElement("div",{className:"map-detail-wrapper"},s.a.createElement("div",{className:"mini-map"},s.a.createElement("img",{alt:"map",src:"https://www.mapquestapi.com/staticmap/v5/map?key=Rum6uC90qtUc0AkV3bXdLYhrlxdqGi3K&center=".concat(this.state.lat||p,",").concat(this.state.lon||d,"&size=@2x")})),s.a.createElement("p",{onBlur:function(t){e._updateDetails(t.target.textContent)},contentEditable:!0,suppressContentEditableWarning:!0},u||"Click here to enter Trip Details"))),s.a.createElement(x.a,{onDrop:this._onDrop,accept:"image/*",minSize:0,maxSize:5242880,multiple:!0},(function(e){var t=e.getRootProps,a=e.getInputProps,i=e.isDragActive,r=e.isDragReject,o=e.isFileTooLarge;return s.a.createElement("section",{className:"container dragdrop center"},s.a.createElement("div",Object.assign({className:"dragdrop-div"},t()),s.a.createElement("div",{className:"btn-floating addtripphotobtn"},s.a.createElement("i",{className:"material-icons "},"add")),s.a.createElement("input",a()),s.a.createElement("p",{className:"dragDrop-p"},n.length>0?s.a.createElement("ul",null,n.map((function(e){return s.a.createElement("li",null,e.key)}))):null,0===n.length&&!i&&"Drag & Drop image files here to upload photos of your trip!",0===n.length&&i&&!r&&"Drop it like it's hot!",0===n.length&&r&&"File type not accepted, sorry!",0===n.length&&o&&s.a.createElement("div",{className:"text-danger mt-2"},"File is too large."))))})),s.a.createElement("br",null),s.a.createElement("br",null),h?s.a.createElement("div",{className:"carousel-wrapper"},s.a.createElement("div",{ref:this.carouselInstance,id:"carousel",className:"carousel carousel-slider"},h),s.a.createElement("div",{className:"carousel-close",title:"delete photo",onClick:this._deleteMe},s.a.createElement("i",{className:"material-icons"},"delete"))):null)}}]),t}(s.a.Component),q=k()(new Date).format();function z(e){return function(t){return t.trip_location.toLowerCase().includes(e.toLowerCase())||!e}}var W=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e)))._goAwayModal=function(){a.setState({showModal:!1})},a._comeBackModal=function(){a.setState({showModal:!0})},a._selectTripId=function(e){a.setState({selectedTripId:e})},a._deSelectTrip=function(){a.setState({selectedTripId:null})},a._onPastChange=function(){a.setState({pastTrips:!a.state.pastTrips},a._filterTripsByDate)},a._onFutureChange=function(){a.setState({futureTrips:!a.state.futureTrips},a._filterTripsByDate)},a._filterTripsByDate=function(){var e=[];a.state.pastTrips&&a.state.futureTrips&&a.props.trips.forEach((function(t){e.push(t)})),!a.state.pastTrips&&a.state.futureTrips&&a.props.trips.forEach((function(t){k()(t.trip_date.split("T").shift()).format()>q&&e.push(t)})),!a.state.futureTrips&&a.state.pastTrips&&a.props.trips.forEach((function(t){k()(t.trip_date.split("T").shift()).format()<q&&e.push(t)})),a.state.futureTrips||a.state.pastTrips||(e=[]),a.setState({viewableTrips:e})},a._searchHandler=function(e){a.setState({searchWord:e.target.value})},a._clickedOnTrip=function(){var e=Object(c.a)(l.a.mark((function e(t){var n,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/trips/".concat(t));case 2:n=e.sent,s=n.data,i=s.clickedTrip,a.setState({clickedTrip:i});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a._clearClickedTrip=function(){a.setState({clickedTrip:null})},a.state={selectedTripId:null,clickedTrip:null,pastTrips:!0,futureTrips:!0,trips:[],viewableTrips:[],didSetTrips:!1,showModal:!0,searchWord:""},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.updateApp,a=e.trips,n=this.state,i=n.viewableTrips,r=n.clickedTrip,o=null;r&&r.trip_photos&&(o=r.trip_photos.map((function(e){return e})));var l=r?s.a.createElement(Y,{name:r.trip_location,id:r.id,shutTheDoorBehindYou:this._clearClickedTrip,details:r.trip_details,date:r.trip_date,lat:r.lat,lon:r.lon,photos:o,updateAppDashboard:this.props.updateApp}):null;return s.a.createElement("div",{className:"dashboard"},s.a.createElement("div",{className:"dashboard-map-n-tools"},s.a.createElement("div",{className:"dashboard-tools"},this.state.showModal?s.a.createElement(L,{hushModal:this._goAwayModal,comeBack:this._comeBackModal,updateAppDashboard:t}):null,s.a.createElement("div",{className:"addtrip-searchtrip"},s.a.createElement("a",{href:"#newtrip",title:"add new trip",className:a.length<=0?"pulse modal-trigger addTrip btn-floating waves-effect waves-light":"modal-trigger addTrip btn-floating waves-effect waves-light"},s.a.createElement("i",{className:"pulse material-icons addtrip"},"add")),a.length<=0?null:s.a.createElement(B,{search:this._searchHandler})),l,s.a.createElement("div",{className:"dashboard-toggle-list"},s.a.createElement("div",{className:""},a.length<=0?null:s.a.createElement(D,{past:this.state.pastTrips,future:this.state.futureTrips,changePast:this._onPastChange,changeFuture:this._onFutureChange})),a.length<=0?s.a.createElement("div",{className:"get-started-text"},"Add your first trip by clicking the flashing button above!"):s.a.createElement(T,{trips:i.filter(z(this.state.searchWord)).map((function(e){return e})),tripDeselector:this._deSelectTrip,tripSelector:this._selectTripId,selectedTrip:this.state.selectedTripId,updateAppDashboard:t,clickedTrip:this._clickedOnTrip}))),s.a.createElement("div",{id:"mapbox",className:""},s.a.createElement(I,{trips:i.filter(z(this.state.searchWord)).map((function(e){return e})),tripDeselector:this._deSelectTrip,tripSelector:this._selectTripId,selectedTrip:this.state.selectedTripId,updateAppDashboard:t,clickedTrip:this._clickedOnTrip}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.trips.length>0&&!t.didSetTrips)return{trips:e.trips,didSetTrips:!0,viewableTrips:e.trips};if(e.trips.length===t.trips.length&&t.pastTrips&&t.futureTrips)return{trips:e.trips,viewableTrips:e.trips};var a=[];return t.pastTrips&&t.futureTrips&&e.trips.forEach((function(e){a.push(e)})),!t.pastTrips&&t.futureTrips&&e.trips.forEach((function(e){k()(e.trip_date.split("T").shift()).format()>q&&a.push(e)})),!t.futureTrips&&t.pastTrips&&e.trips.forEach((function(e){k()(e.trip_date.split("T").shift()).format()<q&&a.push(e)})),t.futureTrips||t.pastTrips||(a=[]),{trips:e.trips,viewableTrips:a}}}]),t}(n.Component);f.a.defaults.withCredentials=!0;var V=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).getTripsByUserId=Object(c.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/trips",{withCredentials:!0});case 2:t=e.sent,n=t.data,a.setState({trips:n});case 5:case"end":return e.stop()}}),e)}))),a.getUserById=Object(c.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/users",{withCredentials:!0});case 2:t=e.sent,n=t.data,a.setState({user:n});case 5:case"end":return e.stop()}}),e)}))),a.state={trips:[]},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.getTripsByUserId()}},{key:"render",value:function(){return s.a.createElement("div",{className:"App"},s.a.createElement(_,{user:this.props.user,clearState:this.props.handleSignOut,updateLanding:this.props.updateLanding}),s.a.createElement(W,{trips:this.state.trips,updateApp:this.getTripsByUserId}))}}]),t}(n.Component),H=a(39),J=a.n(H),X=function(){return s.a.createElement("div",{class:"loader"},"Loading...")};f.a.defaults.withCredentials=!0;var G=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e)))._signIn=function(e){a.setState({user:e})},a._clearUser=function(){a.setState({user:{}})},a._updateUser=Object(c.a)(l.a.mark((function e(){var t,n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/users");case 2:t=e.sent,n=t.data,s=n.user,a.setState({user:s});case 6:case"end":return e.stop()}}),e)}))),a._showModal=function(){a.setState({modalShouldShow:!0})},a._hideModal=function(){a.setState({modalShouldShow:!1})},a.state={user:{},modalShouldShow:!0,loading:!0},f.a.get("/session").then((function(e){var t=e.data;return a._signIn(t.user)})).then((function(){a.setState({loading:!1})})),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.state.user.id&&(document.body.style.backgroundImage=null),this.state.user.id?s.a.createElement(V,{user:this.state.user,handleSignOut:this._clearUser,updateLanding:this._updateUser}):this.state.loading?s.a.createElement(X,null):s.a.createElement("div",{className:"container right column"},s.a.createElement("div",{className:"landing-page-div"},s.a.createElement(w,{signInUser:this._signIn,showModal:this._showModal,hideModal:this._hideModal})),s.a.createElement(J.a,{id:"loading",open:this.state.modalShouldShow,actions:"\xa0",options:{dismissible:!1}},s.a.createElement("div",{className:"preloader-wrapper big active center-align"},s.a.createElement("div",{className:"spinner-layer spinner-teal-only"},s.a.createElement("div",{className:"circle-clipper left"},s.a.createElement("div",{className:"circle"})),s.a.createElement("div",{className:"gap-patch"},s.a.createElement("div",{className:"circle"})),s.a.createElement("div",{className:"circle-clipper right"},s.a.createElement("div",{className:"circle"}))))))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},63:function(e,t,a){e.exports=a(146)},68:function(e,t,a){},87:function(e,t,a){}},[[63,1,2]]]);
//# sourceMappingURL=main.6811d71f.chunk.js.map